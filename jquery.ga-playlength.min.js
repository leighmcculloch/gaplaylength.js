/*!
 * @preserve
 * jquery.ga-playlength.js | v0.2
 * Copyright (c) 2014 Leigh McCulloch
 * Licensed under the BSD 3-clause license.
 *
 * Inspired by and derived from jquery.scrolldepth.js
 * which may be freely distributed under the MIT and GPL licenses.
 * Copyright (c) 2014 Rob Flaherty (@robflaherty).
 */
!function(e){"use strict";var n,t,a,i,r={audioTime:!0,userTiming:!0},u=[];e.fn.gaPlayLength=function(o){return this.each(function(){function g(e,r,u,g){i?(dataLayer.push({event:"PlayLength",eventCategory:"Play Length",eventAction:e,eventLabel:r,eventValue:1,eventNonInteraction:!0}),o.audioTime&&arguments.length>2&&u>n&&(n=u,dataLayer.push({event:"PlayLength",eventCategory:"Play Length",eventAction:"Audio Time",eventLabel:h(u),eventValue:1,eventNonInteraction:!0})),o.userTiming&&arguments.length>3&&dataLayer.push({event:"PlayTiming",eventCategory:"Play Length",eventAction:e,eventLabel:r,eventTiming:g})):(t&&(ga("send","event","Play Length",e,r,1,{nonInteraction:1}),o.audioTime&&arguments.length>2&&u>n&&(n=u,ga("send","event","Play Length","Audio Time",h(u),1,{nonInteraction:1})),o.userTiming&&arguments.length>3&&ga("send","timing","Play Length",e,g,r)),a&&(_gaq.push(["_trackEvent","Play Length",e,r,1,!0]),o.audioTime&&arguments.length>2&&u>n&&(n=u,_gaq.push(["_trackEvent","Play Length","Audio Time",h(u),1,!0])),o.userTiming&&arguments.length>3&&_gaq.push(["_trackTiming","Play Length",e,g,r,100])))}function s(e){return{"10%":parseInt(.1*e,10),"25%":parseInt(.25*e,10),"50%":parseInt(.5*e,10),"75%":parseInt(.75*e,10)}}function h(e){return(10*Math.floor(e/10)).toString()}/*!
       * @preserve
       * Throttle function borrowed from:
       * Underscore.js 1.5.2
       * http://underscorejs.org
       * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
       * Underscore may be freely distributed under the MIT license.
       */
function l(e,n){var t,a,i,r=null,u=0,o=function(){u=new Date,r=null,i=e.apply(t,a)};return function(){var g=new Date;u||(u=g);var s=n-(g-u);return t=this,a=arguments,0>=s?(clearTimeout(r),r=null,u=g,i=e.apply(t,a)):r||(r=setTimeout(o,s)),i}}var c=+new Date;o=e.extend({},r,o),"function"==typeof ga&&(t=!0),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(a=!0),"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(i=!0),e(this).on("play",function(){var n="Baseline";-1===e.inArray(n,u)&&(g("Percentage",n),u.push(n))}),e(this).on("timeupdate",l(function(){var n=this.duration,t=this.currentTime;if(!isNaN(this.duration)){var a=s(n),i=+new Date-c;e.each(a,function(n,a){-1===e.inArray(n,u)&&t>=a&&(g("Percentage",n,t,i),u.push(n))})}},500)),e(this).on("ended",function(){var n="100%";if(-1===e.inArray(n,u)){var t=+new Date-c;g("Percentage",n,this.duration,t),u.push(n)}})})}}(jQuery);